// Default to 10 seconds less than expected expiry to give some wiggle room near the end
// https://github.com/xmtp/xmtp-node-go/blob/main/pkg/api/authentication.go#L18
const DEFAULT_MAX_AGE_SECONDS = 60 * 60 - 10;
export default class AuthCache {
    constructor(authenticator, cacheExpirySeconds = DEFAULT_MAX_AGE_SECONDS) {
        this.authenticator = authenticator;
        this.maxAgeMs = cacheExpirySeconds * 1000;
    }
    async getToken() {
        if (!this.token || this.token.ageMs > this.maxAgeMs) {
            await this.refresh();
        }
        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
        return this.token.toBase64();
    }
    async refresh() {
        this.token = await this.authenticator.createToken();
    }
}
//# sourceMappingURL=AuthCache.js.map