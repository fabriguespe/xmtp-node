import { dateToNs } from '../utils';
import Token from './Token';
const wrapToken = (token) => {
    if (token instanceof Token) {
        return token;
    }
    return new Token(token);
};
export default class KeystoreAuthenticator {
    constructor(keystore) {
        this.keystore = keystore;
    }
    async createToken(timestamp) {
        const token = await this.keystore.createAuthToken({
            timestampNs: timestamp ? dateToNs(timestamp) : undefined,
        });
        return wrapToken(token);
    }
}
//# sourceMappingURL=KeystoreAuthenticator.js.map